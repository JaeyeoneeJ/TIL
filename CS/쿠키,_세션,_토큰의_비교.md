처음 관련 자료를 접했을 때 쿠키와 세션은 독립적인 별개의 것이라고 생각했는데 그렇지 않았다.
애매하게 혼동되는 쿠키, 세션, 토큰의 개념을 한번 더 정리해보자.

http 통신은 stateless(요청에 대한 응답만 처리하는 방식)한 그 특징 때문에 사용자의 주고받은 개별 통신에 대한 정보를 저장하지 않는다.
때문에 같은 사용자가 여러 번 요청을 하더라도 그것을 알 수 없고, 사용자에 대한 상태를 파악할 수 없다.
이것을 보완하기 위해 쿠키와 세션이 있다.

1. Cookie
	: 쿠키는 일종의 서버와 클라이언트가 대화하기 위한 수단이다.
	- 브라우저가 서버와 연결이 되었을 때 브라우저에서 자동적으로 쿠키를 생성하고, response 할 때 쿠키를 담아서 보냄
	- 특정 호스트에서 생성된 쿠키는 이후 모든 요청마다 서버로 전송됨
	- 요청 해더의 set-cookie 속성에 정보를 담을 수 있음.
	- 쿠키에 담긴 데이터는 브라우저에서 관리됨.
	- 이름, 값, 만료 날짜, 경로 정보로 구성.
	: 쿠키 사용의 예
	- 방문 사이트에서 로그인 시, "아이디와 비밀번호를 저장하시겠습니까?"
	- 쇼핑몰의 장바구니 기능
	- 자동로그인, 팝업에서 "오늘 더 이상 이 창을 보지 않음" 체크

2. Session
	: 서버와 클라이언트의 연결이 활성화된 상태.
	- 클라이언트가 서버와 통신을 시작하면 서버는 해당 클라이언트에 대해 유일한 값인 세션 id를 부여, 세션 스토리지에 세션 정보를 저장함.
	- 클라이언트는 이 세션id를 쿠키를 통해 기억함.
	- 이후 클라이언트가 어떤 요청을 보낼 때마다 헤더의 cookie에 세션 id를 담아서 전송함.
	- 서버는 클라이언트가 보낸 요청의 쿠키에 담긴 세션 id와 세션 스토리지에 담긴 세션 id를 대조해 인증 상태를 판단함.(즉, 세션과 쿠키는 완전히 분리된 개념이 아니며 세션은 쿠키를 기반으로 함)
	- 각 클라이언트마다 유니크한 세션 객체가 주어지고, 이 세션 객체에 데이터를 담아 관리할 수 도 있음.(세션 객체가 자물쇠로 잠긴 상자라면 세션 id 가 열쇠인 셈)
	- 세션을 사용하지 않고 쿠키만으로 어떤 데이터를 주고받는다면, 클라이언트는 이미 모든 데이터를 알고 있다는 것.

3. 쿠키와 세션의 차이
	- 쿠키와 세션은 비슷한 역할을 하며, 동작원리도 비슷합니다. 그 이유는 세션도 결국 쿠키를 사용하기 때문입니다.
	- 가장 큰 차이점은 사용자의 정보가 저장되는 위치입니다. 때문에 쿠키는 서버의 자원을 전혀 사용하지 않으며, 세션은 서버의 자원을 사용합니다.
	- 보안 면에서 세션이 더 우수하며, 요청 속도는 쿠키가 세션보다 더 빠릅니다. 그 이유는 세션은 서버의 처리가 필요하기 때문입니다.
	- 보안, 쿠키는 클라이언트 로컬에 저장되기 때문에 변질되거나 request에서 스니핑 당할 우려가 있어서 보안에 취약하지만 세션은 쿠키를 이용해서 sessionid 만 저장하고 그것으로 구분해서 서버에서 처리하기 때문에 비교적 보안성이 좋습니다.
	- 라이프 사이클, 쿠키도 만료시간이 있지만 파일로 저장되기 때문에 브라우저를 종료해도 계속해서 정보가 남아 있을 수 있다. 또한 만료기간을 넉넉하게 잡아두면 쿠키삭제를 할 때 까지 유지될 수도 있습니다.
	- 반면에 세션도 만료시간을 정할 수 있지만 브라우저가 종료되면 만료시간에 상관없이 삭제됩니다. 예를 들어, 크롬에서 다른 탭을 사용해도 세션을 공유됩니다. 다른 브라우저를 사용하게 되면 다른 세션을 사용할 수 있습니다.
	- 속도, 쿠키에 정보가 있기 때문에 서버에 요청시 속도가 빠르고 세션은 정보가 서버에 있기 때문에 처리가 요구되어 비교적 느린 속도를 가집니다.
	- 세션은 서버의 자원을 사용하기 때문에 무분별하게 만들다보면 서버의 메모리가 감당할 수 없어질 수가 있고 속도가 느려질 수 있기 때문에 쿠키가 유리한 경우가 있습니다.

4. Token
	: 인증을 위해 사용되는 암호화된 문자열.
	- 사용자가 인증에 성공하면 서버는 토큰을 생성해서 클라이언트로 보냄
	- 토큰도 세션과 마찬가지로 사용자가 보내는 요청에 포함이 됨.
	- 세션 인증에서는 서버가 세션 id를 저장하고 클라이언트가 쿠키에 실어 보낸 세션 id와 대조해서 확인하는 반면, 토큰을 사용하면 요청을 받은 서버는 토큰이 유효한지를 확인만 함. http통신의 stateless한 성격과 더 적합한 인증 방식.
	- 세션 인증에 비해 서버 운영의 효율이 더 좋다.

5. 쿠키/세션은 캐시와 엄연히 다르다!
	- 캐시는 이미지나 css, js파일 등을 브라우저나 서버 앞 단에 저장해놓고 사용하는 것입니다.
	- 한번 캐시에 저장되면 브라우저를 참고하기 때문에 서버에서 변경이 되어도 사용자는 변경되지 않게 보일 수 있는데 이런 부분을 캐시를 지워주거나 서버에서 클라이언트로 응답을 보낼 때 header에 캐시 만료시간을 명시하는 방법등을 이용할 수 있습니다.
	- 보통 쿠키와 세션의 차이를 물어볼 때 저장위치와 보안에 대해서는 잘 말하는데 사실 중요한 것은 라이프사이클을 얘기하는 것입니다.

6. 그렇다면 세션과 토큰 인증 어떤 게 더 나은 선택일까?
	- 아직 경험이 없지만, 일반적으로 두 가지 모두 유효한 방법이라고 함.
	- 웹사이트의 규모, 핸들링할 요청의 종류에 따라 선택할 수 있다고 하는데, 유저의 로그인 세션 정도만 인증이 필요한 작은 웹사이트에서는 세션 인증이 보통 좋은 선택이 될 수 있음.
	- 하지만 규모가 큰 웹사이트라면 제이슨 웹 토큰(JWT)이 훨씬 나은 선택이 될 수 있다고 함.


--------

Ref.
	- https://dev.to/vasilevskialeks/token-vs-session-authentication-56ed
	- https://interconnection.tistory.com/74
